<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TamAi v3 - Smart Chat Assistant</title>
    
    <!-- CSS Files (Modular) -->
    <link rel="stylesheet" href="../src/css/main.css">
    <link rel="stylesheet" href="../src/css/login.css">
    <link rel="stylesheet" href="../src/css/chat.css">
    
    <!-- SMTPJS Library untuk OTP Email -->
    <script src="https://smtpjs.com/v3/smtp.js"></script>
</head>
<body>
    <!-- ========================================
         AUTH MODAL
         ======================================== -->
    <div id="authModal" class="auth-modal active">
        <div class="auth-container">
            <!-- LOGIN FORM -->
            <div id="loginForm" class="auth-form active">
                <div class="auth-header">
                    <h1>TamAi</h1>
                    <p class="subtitle">Smart Chat Assistant v3</p>
                </div>
                
                <form id="loginFormElement" class="form">
                    <div class="form-group">
                        <label for="loginEmail">Email Address</label>
                        <input type="email" id="loginEmail" placeholder="your@email.com" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="loginPassword">Password</label>
                        <input type="password" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">Sign In</button>
                </form>
                
                <div class="auth-divider">
                    <span>Don't have an account?</span>
                </div>
                
                <button type="button" class="btn btn-secondary" onclick="window.TamAi.uiManager.switchAuthForm('registerForm')">Create New Account</button>
            </div>

            <!-- REGISTER FORM -->
            <div id="registerForm" class="auth-form">
                <div class="auth-header">
                    <h2>Create Account</h2>
                    <p class="subtitle">Join TamAi v3</p>
                </div>
                
                <form id="registerFormElement" class="form">
                    <div class="form-group">
                        <label for="registerUsername">Username</label>
                        <input type="text" id="registerUsername" placeholder="your_username" required>
                        <small>Lowercase, no spaces</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="registerDisplayName">Display Name</label>
                        <input type="text" id="registerDisplayName" placeholder="Your Full Name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="registerEmail">Email Address</label>
                        <input type="email" id="registerEmail" placeholder="your@email.com" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="registerPassword">Password</label>
                        <input type="password" id="registerPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                        <small>Minimum 6 characters</small>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">Continue to OTP</button>
                </form>
                
                <button type="button" class="btn btn-secondary" onclick="window.TamAi.uiManager.switchAuthForm('loginForm')">Back to Login</button>
            </div>

            <!-- OTP VERIFICATION FORM -->
            <div id="otpForm" class="auth-form">
                <div class="auth-header">
                    <h2>Verify OTP</h2>
                    <p class="subtitle">Check your email for the code</p>
                </div>
                
                <div id="otpEmailDisplay" class="otp-email-display"></div>
                
                <form id="otpFormElement" class="form">
                    <div class="form-group">
                        <label for="otpCode">Enter OTP Code</label>
                        <div class="otp-input-group">
                            <input type="text" id="otpCode" maxlength="6" placeholder="000000" required class="otp-input">
                        </div>
                        <small>6-digit code from your email</small>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">Verify OTP</button>
                </form>
                
                <div class="otp-resend">
                    <button type="button" id="resendOtpBtn" class="btn btn-text">Resend OTP</button>
                </div>
                <div class="otp-bypass-dev">
                    <button type="button" id="bypassDevBtn" class="btn btn-danger">üîì Bypass Developer</button>
                </div>
            </div>

            <!-- PROFILE PICTURE FORM -->
            <div id="profilePicForm" class="auth-form">
                <div class="auth-header">
                    <h2>Profile Picture</h2>
                    <p class="subtitle">Complete your profile</p>
                </div>
                
                <div class="profile-pic-container">
                    <div id="profilePicPreview" class="profile-pic-preview">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                    </div>
                    <p id="profilePicFileName" class="profile-pic-filename">No image selected</p>
                </div>
                
                <form id="profilePicFormElement" class="form">
                    <div class="form-group">
                        <input type="file" id="profilePicInput" accept="image/*" required>
                        <label for="profilePicInput" class="file-input-label">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="17 8 12 3 7 8"></polyline>
                                <line x1="12" y1="3" x2="12" y2="15"></line>
                            </svg>
                            Click to select or drag image
                        </label>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">Complete Setup</button>
                </form>

                <div class="profile-pic-option">
                    <button type="button" class="btn btn-secondary">Skip for Now</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ========================================
         MAIN APP
         ======================================== -->
    <div id="mainApp" class="app-container hidden">
        <!-- SIDEBAR -->
        <aside id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <h2>TamAi</h2>
                <button id="sidebarToggleClose" class="sidebar-toggle-close" aria-label="Close sidebar">‚úï</button>
            </div>

            <button id="newChatBtn" class="btn btn-primary" style="width: calc(100% - 16px); margin: 12px 8px;">
                ‚ûï New Chat
            </button>

            <div id="chatListContainer" class="chat-list"></div>

            <div class="sidebar-footer">
                <div id="profileSection" class="profile-section">
                    <div id="profileAvatar" class="profile-avatar">
                        <img id="profileAvatarImg" src="" alt="Profile">
                    </div>
                    <div>
                        <div id="profileDisplayName" style="font-size: 14px; font-weight: 600;"></div>
                        <div id="profileUsername" style="font-size: 12px; color: var(--text-muted);"></div>
                    </div>
                    <button id="profileMenuBtn" style="background: none; border: none; color: var(--text-secondary); cursor: pointer; font-size: 18px;">‚ãÆ</button>
                </div>

                <!-- PROFILE MENU -->
                <div id="profileMenu" class="profile-menu hidden">
                    <button id="settingsBtn" class="profile-menu-item" style="background: none; border: none; color: var(--text-secondary); width: 100%; text-align: left; padding: 10px 16px; cursor: pointer;">
                        ‚öôÔ∏è Settings
                    </button>
                    <button id="logoutBtn" class="profile-menu-item" style="background: none; border: none; color: var(--danger); width: 100%; text-align: left; padding: 10px 16px; cursor: pointer;">
                        üö™ Logout
                    </button>
                </div>
            </div>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="main-content">
            <!-- MESSAGES CONTAINER -->
            <div id="messagesContainer" class="messages-container">
                <div id="welcomeMessage" class="welcome-section" style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; text-align: center;">
                    <h2 style="font-size: 32px; background: linear-gradient(135deg, var(--primary), var(--secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">ü§ñ Welcome to TamAi v3</h2>
                    <p style="color: var(--text-secondary); margin-top: 12px;">Powered by Gemini 2.0 Flash Experimental</p>
                </div>
            </div>

            <!-- INPUT AREA -->
            <div class="input-area">
                <textarea 
                    id="messageInput" 
                    class="message-input" 
                    placeholder="Ketik pesan atau tanya AI..."
                    rows="1"
                ></textarea>
                <button id="sendBtn" class="btn btn-primary" style="min-width: 80px; padding: 12px 18px;">
                    üì§ Send
                </button>
            </div>
        </main>
    </div>

    <!-- LOADING SPINNER -->
    <div id="loadingSpinner" class="loading-spinner hidden" style="position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%); padding: 16px; background: var(--bg-secondary); border: 1px solid var(--glass-border); border-radius: 10px; display: flex; align-items: center; gap: 12px; color: var(--text-secondary);">
        <div class="spinner"></div>
        <span>Thinking...</span>
    </div>

    <!-- MAIN APPLICATION (ES6 Modules) -->
    <script type="module" src="../src/js/app.js"></script>
</body>
</html>
